import os
import warnings

import joblib
import numpy as np
import tensorflow as tf

# Suppress TensorFlow logging messages and warnings
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
warnings.filterwarnings("ignore")

# Load the scaler and trained model
scaler = joblib.load('scaler.pkl')
model = tf.keras.models.load_model('model_latest.keras', compile=False)

# Sample new data (ensure it matches the training data format)
new_data = [[1742194747142117120,1.28,-1.26,-1.26,-1.55,1.69,1.69,1.54,-1.59,-1.59,-1.44,-1.44,-1.53,1.59,-1.49,-1.49,-0.36,0.8,-1.06,-1.06,1.42,-1.45,-1.45,-0.93,-0.93,-1.63,1.52,1.52,1.85,1.85,1.21,-1.6,-1.6,-1.62,1.57,1.57,1.35,1.17,1.17,1.91,1.91,0.7,-1.33,-1.33,-1.4,0.87,-1.05,-1.05,-0.75,-0.22,-0.79,-0.79,-1.23,1.25,-1.06,-1.06,-1.34,-1.34,-0.99,1.35,-1.02,0.64,0.64,0.5,-0.39,1.1,-1.1,-1.1,-1.19,1.51,0.08,0.08,-0.45,1.6,-1.14,-1.14,0.22,0.22,1.16,0.29,0.29,-1.91,0.49,0.49,1.5,-1.83,1.63,-1.17,0.57,-1.38,-1.38,-0.24,0.98,-0.7,-0.42,-0.42,0.13,0.23,0.23,0.82,0.82,-0.5,1.19,-1.8,1.27,-0.81,-0.59,1.76,-1.33,1.53,1.53,1.43,1.43,1.43,-1.52,-1.52,-0.97,1.6,-1.45,1.36,-1.74,-1.74,-1.27,-1.27,-0.83,-0.08,-0.08,0.2,0.2,-0.12,-0.12,0.6,-0.59,-0.59,-1.21,-1.21,-1.71,1.32,-0.23,-0.06,-0.11,0.47,0.01,0.01,-0.59,-0.59,0.03,0.03,0.74,1.29,1.29,1.0,-1.55,-1.55,-1.52,1.49,-1.39,-1.39,-1.47,1.31,-1.1,-1.1,-0.17,0.94,-0.33,0.28,0.3,-0.28,-0.28,-1.0,0.72,-0.6,-0.6,-0.04,-0.95,0.37,0.37,-0.5,-0.31,0.36,0.36,0.51,0.51,1.64,-1.67,-1.67,-0.65,1.51,1.51,1.17,1.17,1.3,-1.2,-0.35,-0.35,-1.77,1.83,-0.85,1.58,-1.36,0.98,-0.12,-0.06,-0.06,-0.14,0.21,0.21,0.1,-0.29,-0.29,-0.28,-0.28,-0.24,0.28,-0.27,-0.27,-0.19,-0.01,0.03,0.03,0.0,-0.12,-0.12,-0.07,-0.07,-0.12,0.24,0.24,0.19,0.19,-0.07,-0.13,-0.13,-0.11,0.13,0.13,-0.15,0.23,0.23,0.24,0.24,-0.11,-0.12,-0.12,0.01,-0.07,-0.06,-0.06,0.09,-0.16,0.07,0.07,0.04,0.15,-0.15,-0.15,-0.09,-0.09,-0.06,0.23,-0.19,0.19,0.19,0.18,-0.02,0.06,0.0,0.0,0.04,-0.08,0.07,0.07,-0.13,-0.11,0.04,0.04,0.11,0.11,0.38,-0.16,-0.16,-0.16,0.15,0.15,0.03,-0.15,0.24,-0.34,0.12,-0.05,-0.05,-0.02,-0.17,0.05,-0.05,-0.05,-0.06,-0.13,-0.13,-0.03,-0.03,-0.11,0.1,-0.26,0.2,-0.25,-0.12,0.3,-0.21,0.18,0.18,-0.05,-0.05,0.18,-0.08,-0.08,-0.07,0.02,0.04,-0.04,-0.16,-0.16,-0.15,-0.15,0.01,-0.14,-0.14,-0.13,-0.13,-0.14,-0.14,-0.13,-0.08,-0.08,-0.05,-0.05,-0.05,0.02,-0.03,0.08,-0.08,0.14,-0.1,-0.1,-0.17,-0.17,-0.09,-0.09,-0.01,0.18,0.18,0.16,-0.33,-0.33,-0.29,0.22,-0.2,-0.2,-0.23,0.17,-0.29,-0.29,-0.19,-0.02,0.08,-0.12,0.08,0.09,0.09,-0.04,0.02,0.08,0.08,0.15,-0.23,0.1,0.1,0.02,-0.19,0.12,0.12,0.08,0.08,0.14,-0.23,-0.23,-0.07,0.02,0.02,0.13,0.13,-0.16,-0.06,0.02,0.02,-0.21,0.07,-0.13,-0.09,-0.01,-0.05,-0.82,-1.28,-1.28,-1.31,-0.67,-0.67,-0.68,-1.17,-1.17,-1.17,-1.17,-1.17,-0.84,-1.01,-1.01,-0.86,-1.16,-1.01,-1.01,-0.73,-1.26,-1.26,-1.26,-1.26,-1.21,-0.71,-0.71,-0.66,-0.66,-0.82,-1.29,-1.29,-1.31,-0.73,-0.73,-0.85,-0.87,-0.87,-0.63,-0.63,-0.82,-1.26,-1.26,-1.01,-0.77,-1.2,-1.2,-0.92,-0.98,-1.16,-1.16,-1.18,-0.73,-1.23,-1.23,-1.24,-1.24,-1.26,-0.72,-1.09,-0.99,-0.99,-0.98,-0.8,-0.89,-1.06,-1.06,-1.12,-0.7,-0.91,-0.91,-0.81,-0.99,-0.98,-0.98,-0.94,-0.94,-0.77,-0.92,-0.92,-1.4,-0.87,-0.87,-0.69,-1.3,-0.8,-0.97,-1.07,-0.9,-0.9,-0.79,-1.08,-1.07,-0.88,-0.88,-0.86,-1.21,-1.21,-1.1,-1.1,-1.25,-0.69,-1.18,-0.88,-0.95,-1.14,-0.76,-1.02,-0.93,-0.93,-0.98,-0.98,-0.96,-0.93,-0.93,-0.9,-0.95,-1.03,-0.72,-1.39,-1.39,-1.25,-1.25,-1.01,-0.87,-0.87,-0.93,-0.93,-0.9,-0.9,-0.88,-1.1,-1.1,-1.22,-1.22,-0.97,-0.88,-1.06,-0.84,-1.15,-0.88,-0.88,-0.88,-0.89,-0.89,-0.82,-0.82,-1.04,-0.74,-0.74,-0.82,-1.18,-1.18,-1.21,-0.89,-0.91,-0.91,-0.95,-1.04,-0.9,-0.9,-0.93,-1.15,-0.85,-0.95,-1.05,-0.82,-0.82,-0.84,-1.05,-1.0,-1.0,-0.87,-0.98,-1.09,-1.09,-0.89,-1.02,-1.07,-1.07,-1.05,-1.05,-0.65,-1.23,-1.23,-1.1,-0.73,-0.73,-0.75,-0.75,-0.86,-1.21,-0.75,-0.75,-1.05,-0.95,-0.88,-0.97,-1.07,-0.8]] 

# Normalize and reshape the new data
new_data_scaled = scaler.transform(new_data).reshape(len(new_data), -1, 1, 1)

# Predict using the trained model
predictions = model.predict(new_data_scaled)
predicted_classes = np.argmax(predictions, axis=1)

# Map predictions to labels
labels = {0: "Close", 1: "Normal", 2: "Fault"}
for idx, pred_class in enumerate(predicted_classes):
    print(f"Prediction: {labels.get(pred_class, 'Unknown')}")
